
var contatos = [
    {_id : 1, nome : 'Contato Exemplo 1', email : 'cont1@empresa.com.br'},
    {_id : 2, nome : 'Contato Exemplo 2', email : 'cont2@empresa.com.br'},
    {_id : 3, nome : 'Contato Exemplo 3', email : 'cont3@empresa.com.br'}
];

module.exports = function() {
    var controller = {};
    
    controller.listaContatos = function(req, res) {
        res.json(contatos);
    };
    
    controller.obtemContato = function(req, res) {
        var idContato = req.params.id;
        var contato = contatos.filter(function(contato) {
            return contato._id == idContato;
        })[0];
        contato ? res.json(contato) : res.status(404).send('Contato n√£o encontrado');
        console.log('ContatoController: Buscando contato: ' + req.params.id);
    };
    
    controller.removeContato = function(req, res) {
        var idContato = req.params.id;
        contatos = contatos.filter(function (contato) {
            return contato._id != idContato;
        });
        res.status(204).end();
        console.log('ContatoController: Removendo contato: ' + idContato);
    };    
    
    controller.salvaContato = function(req, res) {
        var contato = req.body;
        contato._id = contatos.length + 1;
        contatos.push(contato);
        res.json(contato);
        console.log('ContatoController: Salvando contato: ' + contato.nome);
    };
    
    controller.alteraContato = function(req, res) {
        var contatoAlterado = req.body;
        contatos = contatos.map(function (contato) {
            if (contato._id == contatoAlterado._id) {
                var contato = contatoAlterado;                
            }
            return contato;
        });
        res.json(contatoAlterado);
        console.log('ContatoController: Alterando contato: ' + contatoAlterado.nome);
    }
    
    return controller;
};